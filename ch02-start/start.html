<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2. Get Started &#8212; Qt5 Cadaques Book vmaster</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom-styles.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Qt Creator IDE" href="../ch03-qtcreator/qtcreator.html" />
    <link rel="prev" title="1. Meet Qt 5" href="../ch01-meetqt/meetqt.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          QmlBook</a>
        <span class="navbar-text navbar-version pull-left"><b>master</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ch01-meetqt/meetqt.html">1. Meet Qt 5</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch03-qtcreator/qtcreator.html">3. Qt Creator IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch04-qmlstart/qmlstart.html">4. Quick Starter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch05-fluid/fluid.html">5. Fluid Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch06-controls/controls.html">6. Qt Quick Controls 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch07-modelview/modelview.html">7. Model-View-Delegate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch08-felgo/felgo.html">8. Felgo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch09-canvas/canvas.html">9. Canvas Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch10-particles/particles.html">10. Particle Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch11-shaders/shaders.html">11. Shader Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch12-multimedia/multimedia.html">12. Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch13-networking/networking.html">13. Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch14-storage/storage.html">14. Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch15-dynamicqml/dynamicqml.html">15. Dynamic QML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch16-javascript/javascript.html">16. JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch17-qtcpp/qtcpp.html">17. Qt and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch18-extensions/extensions.html">18. Extending QML with C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch19-felgo-plugins/felgo-plugins.html">19. Felgo Plugins and QML Hot Reloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch20-python/python.html">20. Qt for Python</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/testing.html">1. Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/deployment.html">2. Deploying QML Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../draganddrop/draganddrop.html">3. Drag and Drop</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">2. Get Started</a><ul>
<li><a class="reference internal" href="#installing-qt-5-sdk">2.1. Installing Qt 5 SDK</a></li>
<li><a class="reference internal" href="#hello-world">2.2. Hello World</a></li>
<li><a class="reference internal" href="#application-types">2.3. Application Types</a><ul>
<li><a class="reference internal" href="#console-application">2.3.1. Console Application</a></li>
<li><a class="reference internal" href="#c-widget-application">2.3.2. C++ Widget Application</a></li>
<li><a class="reference internal" href="#adapting-data">2.3.3. Adapting Data</a></li>
<li><a class="reference internal" href="#qt-quick-application">2.3.4. Qt Quick Application</a></li>
<li><a class="reference internal" href="#qt-quick-controls-application">2.3.5. Qt Quick Controls Application</a></li>
<li><a class="reference internal" href="#id1">2.3.6. Qt Quick Controls Application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">2.4. Summary</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../ch01-meetqt/meetqt.html" title="Previous Chapter: 1. Meet Qt 5"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 1. Meet Qt 5</span>
    </a>
  </li>
  <li>
    <a href="../ch03-qtcreator/qtcreator.html" title="Next Chapter: 3. Qt Creator IDE"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">3. Qt Creator IDE &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">2. Get Started</a><ul>
<li><a class="reference internal" href="#installing-qt-5-sdk">2.1. Installing Qt 5 SDK</a></li>
<li><a class="reference internal" href="#hello-world">2.2. Hello World</a></li>
<li><a class="reference internal" href="#application-types">2.3. Application Types</a><ul>
<li><a class="reference internal" href="#console-application">2.3.1. Console Application</a></li>
<li><a class="reference internal" href="#c-widget-application">2.3.2. C++ Widget Application</a></li>
<li><a class="reference internal" href="#adapting-data">2.3.3. Adapting Data</a></li>
<li><a class="reference internal" href="#qt-quick-application">2.3.4. Qt Quick Application</a></li>
<li><a class="reference internal" href="#qt-quick-controls-application">2.3.5. Qt Quick Controls Application</a></li>
<li><a class="reference internal" href="#id1">2.3.6. Qt Quick Controls Application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">2.4. Summary</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="get-started">
<h1>2. Get Started<a class="headerlink" href="#get-started" title="Permalink to this headline">Â¶</a></h1>
<p><em>Section author: <a class="reference external" href="https://www.linkedin.com/in/jryannel">jryannel&#64;LinkedIn</a></em></p>
<p><div class="btn-group btn-group-justified" role="group"><a class="btn btn-primary btn-xs" href="https://github.com/qmlbook/qmlbook/" target="_blank">Github</a><a class="btn btn-primary btn-xs" href="https://github.com/qmlbook/qmlbook//blob/master/docs/ch02-start/start.rst" target="_blank"><i class="glyphicon glyphicon-file"></i> View</a><a class="btn btn-primary btn-xs" href="https://github.com/qmlbook/qmlbook//edit/master/docs/ch02-start/start.rst" target="_blank"><i class="glyphicon glyphicon-pencil"></i> Edit</a><a class="btn btn-primary btn-xs" href="https://github.com/qmlbook/qmlbook//issues/new?labels=ch02&body=back-link%3A+ch02-start%2Fstart.html%23get-started" target="_blank"><i class="glyphicon glyphicon-plus"></i> Issue </a><a  class="btn btn-primary btn-xs" href="https://github.com/qmlbook/qmlbook//issues?labels=ch02&page=1&state=open" target="_blank"><i class="glyphicon glyphicon-search"></i> Issues</a></div></p><p>This chapter will introduce you to developing with Qt 5. We will show you how to install the Qt SDK and how you can create as well as run a simple <em>hello world</em> application using the Qt Creator IDE.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The source code of this chapter can be found in the <a class="reference external" href="../assets">assets folder</a>.</p>
</div>
<div class="section" id="installing-qt-5-sdk">
<h2>2.1. Installing Qt 5 SDK<a class="headerlink" href="#installing-qt-5-sdk" title="Permalink to this headline">Â¶</a></h2>
<p><div class="btn-group" role="group"><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook//new?labels=ch02&body=back-link%3A+ch02-start%2Fstart.html%23installing-qt-5-sdk"><i class="glyphicon glyphicon-plus"></i> Issue</a><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook/?labels=ch02&page=1&state=open"><i class="glyphicon glyphicon-search"></i> Issues</a></div></p><p>The Qt SDK includes the tools you need to build desktop or embedded applications. You can grab the latest version from the <a class="reference external" href="https://qt.io">Qt Company</a>âs homepage. There is an offline and online installer. The author personally prefers the online installer package as it allows you to install and update multiple Qt releases. This is the recommended way to start. The SDK itself has a maintenance tool, which allows you to update the SDK to the latest version.</p>
<p>The Qt SDK is easy to install and comes with its own IDE for rapid development called <em>Qt Creator</em>. The IDE is a highly productive environment for Qt coding and recommended to all readers. Many developers use Qt from the command line, however, and you are free to use the code editor of your choice.</p>
<p>When installing the SDK, you should select the default option and ensure that Qt 5.12 is enabled. Then youâre ready to go.</p>
</div>
<div class="section" id="hello-world">
<h2>2.2. Hello World<a class="headerlink" href="#hello-world" title="Permalink to this headline">Â¶</a></h2>
<p><div class="btn-group" role="group"><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook//new?labels=ch02&body=back-link%3A+ch02-start%2Fstart.html%23hello-world"><i class="glyphicon glyphicon-plus"></i> Issue</a><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook/?labels=ch02&page=1&state=open"><i class="glyphicon glyphicon-search"></i> Issues</a></div></p><p>To test your installation, we will create a small <em>hello world</em> application. Please, open Qt Creator and create a Qt Quick UI Project ( <span class="menuselection">File â£ New File or Project â£ Other Project â£ Qt Quick UI prototype</span> ) and name the project <code class="docutils literal notranslate"><span class="pre">HelloWorld</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Qt Creator IDE allows you to create various types of applications. If not otherwise stated, we always use a <span class="guilabel">Qt Quick UI prototype</span> project.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">A typical Qt Quick application is made out of a runtime called the QmlEngine which loads the initial QML code. The developer can register C++ types with the runtime to interface with the native code. These C++ types can also be bundled into a plugin and then dynamically loaded using an import statement. The <code class="docutils literal notranslate"><span class="pre">qmlscene</span></code> and <code class="docutils literal notranslate"><span class="pre">qml</span></code> tool are pre-made runtimes, which can be used directly. For the beginning, we will not cover the native side of development and focus only on the QML aspects of Qt 5. This is why we start from a <em>prototype</em> project.</p>
</div>
<p>Qt Creator creates several files for you. The <code class="docutils literal notranslate"><span class="pre">HelloWorld.qmlproject</span></code> file is the project file, where the relevant project configuration is stored. This file is managed by Qt Creator, so donât edit it yourself.</p>
<p>Another file, <code class="docutils literal notranslate"><span class="pre">HelloWorld.qml</span></code>, is our application code. Open it and try to understand what the application does before you read on.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// HelloWorld.qml</span>

<span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.12</span>
<span class="kr">import</span> <span class="nx">QtQuick</span><span class="p">.</span><span class="nx">Window</span> <span class="mf">2.12</span>

<span class="nx">Window</span> <span class="p">{</span>
    <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mf">640</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mf">480</span>
    <span class="nx">title</span><span class="o">:</span> <span class="nx">qsTr</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">HelloWord.qml</span></code> program is written in the QML language. Weâll discuss the QML language more in-depth in the next chapter. QML describes the user interface as a tree of hierarchical elements. In this case, a rectangle of 640 x 480 pixels, with a centered text that contains the words âHello Worldâ. To capture user input, a mouse area spans the whole rectangle. When the user interacts with it, the application quits.</p>
<p>To run the application on your own, press the <img alt="creatorrun" src="../_images/qtcreator-run.png" /> <span class="guilabel">Run</span> tool on the left side, or select <span class="menuselection">Build &gt; Run</span> from the menu.</p>
<p>In the background, Qt Creator runs <code class="docutils literal notranslate"><span class="pre">qmlscene</span></code> and passes your QML document as the first argument. The <code class="docutils literal notranslate"><span class="pre">qmlscene</span></code> application parses the document, and launches the user interface. You should see something like this:</p>
<div class="figure">
<img alt="../_images/example.png" src="../_images/example.png" />
</div>
<p>Qt 5 works! That means weâre ready to continue.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If you are a system integrator, youâll want to have Qt SDK installed to get the latest stable Qt release, as well as a Qt version compiled from source for your specific device target.</p>
</div>
<div class="topic">
<p class="topic-title">Build from Scratch</p>
<p>If youâd like to build Qt 5 from the command line, youâll first need to grab a copy of the code repository and build it. Visit <a class="reference external" href="https://wiki.qt.io/Building_Qt_5_from_Git">Qtâs wiki</a> for an up-to-date explanation of how to build Qt from git.</p>
<p>After a successful compilation (and 2 cups of coffee), Qt 5 will be available in the <code class="docutils literal notranslate"><span class="pre">qtbase</span></code> folder. Any beverage will suffice, however, we suggest coffee for best results.</p>
<p>If you want to test your compilation, you can now run the example with the default runtime that comes with Qt 5:</p>
<div class="highlight-qml notranslate"><div class="highlight"><pre><span></span><span class="nx">$</span> <span class="nx">qtbase</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">qmlscene</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="application-types">
<h2>2.3. Application Types<a class="headerlink" href="#application-types" title="Permalink to this headline">Â¶</a></h2>
<p><div class="btn-group" role="group"><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook//new?labels=ch02&body=back-link%3A+ch02-start%2Fstart.html%23application-types"><i class="glyphicon glyphicon-plus"></i> Issue</a><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook/?labels=ch02&page=1&state=open"><i class="glyphicon glyphicon-search"></i> Issues</a></div></p><p>This section is a run through of different application types one can write with Qt 5. Itâs not limited to the selection presented here, but it will give you a better idea of what you can achieve with Qt 5 in general.</p>
<div class="section" id="console-application">
<h3>2.3.1. Console Application<a class="headerlink" href="#console-application" title="Permalink to this headline">Â¶</a></h3>
<p>A console application does not provide a graphical user interface, and is usually called as part of a system service or from the command line. Qt 5 comes with a series of ready-made components which help you create cross-platform console applications very efficiently. For example, the networking file APIs, string handling, and an efficient command line parser. As Qt is a high-level API on top of C++, you get programming speed paired with execution speed. Donât think of Qt as being <em>just</em> a UI toolkit - it has so much more to offer!</p>
<p class="rubric">String Handling</p>
<p>This first example demonstrates how you could add 2 constant strings. Admittedly, this is not a very useful application, but it gives you an idea of what a native C++ application without an event loop may look like.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// module or class includes</span>
<span class="cp">#include</span> <span class="cpf">&lt;QtCore&gt;</span><span class="cp"></span>

<span class="c1">// text stream is text-codec aware</span>
<span class="n">QTextStream</span> <span class="nf">cout</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">QIODevice</span><span class="o">::</span><span class="n">WriteOnly</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// avoid compiler warnings</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">argc</span><span class="p">)</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">QString</span> <span class="n">s1</span><span class="p">(</span><span class="s">&quot;Paris&quot;</span><span class="p">);</span>
    <span class="n">QString</span> <span class="n">s2</span><span class="p">(</span><span class="s">&quot;London&quot;</span><span class="p">);</span>
    <span class="c1">// string concatenation</span>
    <span class="n">QString</span> <span class="n">s</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">s2</span> <span class="o">+</span> <span class="s">&quot;!&quot;</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Container Classes</p>
<p>This example adds a list, and list iteration, to the application. Qt comes with a large collection of container classes that are easy to use, and has the same API paradigms as other Qt classes.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">QString</span> <span class="nf">s1</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span>
<span class="n">QString</span> <span class="nf">s2</span><span class="p">(</span><span class="s">&quot;Qt&quot;</span><span class="p">);</span>
<span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;</span> <span class="n">list</span><span class="p">;</span>
<span class="c1">// stream into containers</span>
<span class="n">list</span> <span class="o">&lt;&lt;</span> <span class="n">s1</span> <span class="o">&lt;&lt;</span> <span class="n">s2</span><span class="p">;</span>
<span class="c1">// Java and STL like iterators</span>
<span class="n">QListIterator</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;</span> <span class="n">iter</span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span><span class="n">iter</span><span class="p">.</span><span class="n">hasNext</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">iter</span><span class="p">.</span><span class="n">next</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">iter</span><span class="p">.</span><span class="n">hasNext</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Here is a more advanced list function, that allows you to join a list of strings into one string. This is very handy when you need to proceed line based text input. The inverse (string to string-list) is also possible using the <code class="docutils literal notranslate"><span class="pre">QString::split()</span></code> function.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">QString</span> <span class="nf">s1</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span>
<span class="n">QString</span> <span class="nf">s2</span><span class="p">(</span><span class="s">&quot;Qt&quot;</span><span class="p">);</span>
<span class="c1">// convenient container classes</span>
<span class="n">QStringList</span> <span class="n">list</span><span class="p">;</span>
<span class="n">list</span> <span class="o">&lt;&lt;</span>  <span class="n">s1</span> <span class="o">&lt;&lt;</span> <span class="n">s2</span><span class="p">;</span>
<span class="c1">// join strings</span>
<span class="n">QString</span> <span class="n">s</span> <span class="o">=</span> <span class="n">list</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;!&quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">File IO</p>
<p>In the next snippet, we read a CSV file from the local directory and loop over the rows to extract the cells from each row. Doing this, we get the table data from the CSV file in ca. 20 lines of code. File reading gives us a byte stream, to be able to convert this into valid Unicode text, we need to use the text stream and pass in the file as a lower-level stream. For writing CSV files, you would just need to open the file in write mode, and pipe the lines into the text stream.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">QList</span><span class="o">&lt;</span><span class="n">QStringList</span><span class="o">&gt;</span> <span class="n">data</span><span class="p">;</span>
<span class="c1">// file operations</span>
<span class="n">QFile</span> <span class="nf">file</span><span class="p">(</span><span class="s">&quot;sample.csv&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">QIODevice</span><span class="o">::</span><span class="n">ReadOnly</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">QTextStream</span> <span class="nf">stream</span><span class="p">(</span><span class="o">&amp;</span><span class="n">file</span><span class="p">);</span>
    <span class="c1">// loop forever macro</span>
    <span class="n">forever</span> <span class="p">{</span>
        <span class="n">QString</span> <span class="n">line</span> <span class="o">=</span> <span class="n">stream</span><span class="p">.</span><span class="n">readLine</span><span class="p">();</span>
        <span class="c1">// test for null string &#39;String()&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">isNull</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// test for empty string &#39;QString(&quot;&quot;)&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">QStringList</span> <span class="n">row</span><span class="p">;</span>
        <span class="c1">// for each loop to iterate over containers</span>
        <span class="n">foreach</span><span class="p">(</span><span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">cell</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">row</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">.</span><span class="n">trimmed</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="n">data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// No cleanup necessary.</span>
</pre></div>
</div>
<p>This concludes the section about console based applications with Qt.</p>
</div>
<div class="section" id="c-widget-application">
<h3>2.3.2. C++ Widget Application<a class="headerlink" href="#c-widget-application" title="Permalink to this headline">Â¶</a></h3>
<p>Console based applications are very handy, but sometimes you need to have a graphical user interface (GUI). In addition, GUI-based applications will likely need a back-end to read/write files, communicate over the network, or keep data in a container.</p>
<p>In this first snippet for widget-based applications, we do as little as needed to create a window and show it. In Qt, a widget without a parent is a window. We use a scoped pointer to ensure that the widget is deleted when the pointer goes out of scope. The application object encapsulates the Qt runtime, and we start the event loop with the <code class="docutils literal notranslate"><span class="pre">exec()</span></code> call. From there on, the application reacts only to events triggered by user input (such as mouse or keyboard), or other event providers, such as networking or file IO. The application only exits when the event loop is exited. This is done by calling <code class="docutils literal notranslate"><span class="pre">quit()</span></code> on the application or by closing the window.</p>
<p>When you run the code, you will see a window with the size of 240 x 120 pixels. Thatâs all.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;QtGui&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QApplication</span> <span class="n">app</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
    <span class="n">QScopedPointer</span><span class="o">&lt;</span><span class="n">QWidget</span><span class="o">&gt;</span> <span class="n">widget</span><span class="p">(</span><span class="k">new</span> <span class="n">CustomWidget</span><span class="p">());</span>
    <span class="n">widget</span><span class="o">-&gt;</span><span class="n">resize</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">120</span><span class="p">);</span>
    <span class="n">widget</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">app</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Custom Widgets</p>
<p>When you work on user interfaces, you may need to create custom-made widgets. Typically, a widget is a window area filled with painting calls. Additionally, the widget has internal knowledge of how to handle keyboard and mouse input, as well as how to react to external triggers. To do this in Qt, we need to derive from <cite>QWidget</cite> and overwrite several functions for painting and event handling.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef CUSTOMWIDGET_H</span>
<span class="cp">#define CUSTOMWIDGET_H</span>

<span class="cp">#include</span> <span class="cpf">&lt;QtWidgets&gt;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">CustomWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">QPoint</span> <span class="n">m_lastPos</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// CUSTOMWIDGET_H</span>
</pre></div>
</div>
<p>In the implementation, we draw a small border on our widget and a small rectangle on the last mouse position. This is very typical for a low-level custom widget. Mouse and keyboard events change the internal state of the widget and trigger a painting update. We wonât go into too much detail about this code, but it is good to know that you have the possibility. Qt comes with a large set of ready-made desktop widgets, so itâs likely that you donât have to do this.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;customwidget.h&quot;</span><span class="cp"></span>

<span class="n">CustomWidget</span><span class="o">::</span><span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="nf">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">QRect</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">rect</span><span class="p">().</span><span class="n">adjusted</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">-10</span><span class="p">,</span><span class="mi">-10</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s">&quot;#33B5E5&quot;</span><span class="p">));</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>

    <span class="n">QRect</span> <span class="nf">r2</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">QSize</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">m_lastPos</span><span class="p">.</span><span class="n">isNull</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">r2</span><span class="p">.</span><span class="n">moveCenter</span><span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">center</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">r2</span><span class="p">.</span><span class="n">moveCenter</span><span class="p">(</span><span class="n">m_lastPos</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">fillRect</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="s">&quot;#FFBB33&quot;</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_lastPos</span> <span class="o">=</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">pos</span><span class="p">();</span>
    <span class="n">update</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_lastPos</span> <span class="o">=</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">pos</span><span class="p">();</span>
    <span class="n">update</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Desktop Widgets</p>
<p>The Qt developers have done all of this for you already and provide a set of desktop widgets, with a native look on different operating systems. Your job, then, is to arrange these different widgets in a widget container into larger panels. A widget in Qt can also be a container for other widgets. This is accomplished through the parent-child relationship. This means we need to make our ready-made widgets, such as buttons, checkboxes, radio buttons, lists, and grids, children of other widgets. One way to accomplish this is displayed below.</p>
<p>Here is the header file for a so-called widget container.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">private</span> <span class="nl">slots</span><span class="p">:</span>
    <span class="kt">void</span> <span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span><span class="o">*</span> <span class="n">item</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">updateItem</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">QListWidget</span> <span class="o">*</span><span class="n">m_widget</span><span class="p">;</span>
    <span class="n">QLineEdit</span> <span class="o">*</span><span class="n">m_edit</span><span class="p">;</span>
    <span class="n">QPushButton</span> <span class="o">*</span><span class="n">m_button</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>In the implementation, we use layouts to better arrange our widgets. Layout managers re-layout the widgets according to some size policies when the container widget is re-sized. In this example, we have a list, a line edit, and a button, which are arranged vertically and allow the user to edit a list of cities. We use Qtâs <code class="docutils literal notranslate"><span class="pre">signal</span></code> and <code class="docutils literal notranslate"><span class="pre">slots</span></code> to connect sender and receiver objects.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">CustomWidget</span><span class="o">::</span><span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QVBoxLayout</span> <span class="o">*</span><span class="n">layout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_widget</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QListWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_widget</span><span class="p">);</span>

    <span class="n">m_edit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_edit</span><span class="p">);</span>

    <span class="n">m_button</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">&quot;Quit&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_button</span><span class="p">);</span>
    <span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span>

    <span class="n">QStringList</span> <span class="n">cities</span><span class="p">;</span>
    <span class="n">cities</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Paris&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;London&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Munich&quot;</span><span class="p">;</span>
    <span class="n">foreach</span><span class="p">(</span><span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">city</span><span class="p">,</span> <span class="n">cities</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_widget</span><span class="o">-&gt;</span><span class="n">addItem</span><span class="p">(</span><span class="n">city</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">connect</span><span class="p">(</span><span class="n">m_widget</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span><span class="o">*</span><span class="p">)),</span> <span class="k">this</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span><span class="o">*</span><span class="p">)));</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">m_edit</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">editingFinished</span><span class="p">()),</span> <span class="k">this</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">updateItem</span><span class="p">()));</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">m_button</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">clicked</span><span class="p">()),</span> <span class="n">qApp</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">quit</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span> <span class="o">*</span><span class="n">item</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Q_ASSERT</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
    <span class="n">m_edit</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">updateItem</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">QListWidgetItem</span><span class="o">*</span> <span class="n">item</span> <span class="o">=</span> <span class="n">m_widget</span><span class="o">-&gt;</span><span class="n">currentItem</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">item</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">m_edit</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Drawing Shapes</p>
<p>Some problems are better visualized. If the problem at hand looks remotely like geometrical objects, Qt graphics view is a good candidate. A graphics view arranges simple geometrical shapes in a scene. The user can interact with these shapes, or they are positioned using an algorithm. To populate a graphics view, you need a graphics view and a graphics scene. The scene is attached to the view and is populated with graphics items.
Here is a short example. First the header file with the declaration of the view and scene.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomWidgetV2</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">CustomWidgetV2</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">QGraphicsView</span> <span class="o">*</span><span class="n">m_view</span><span class="p">;</span>
    <span class="n">QGraphicsScene</span> <span class="o">*</span><span class="n">m_scene</span><span class="p">;</span>

<span class="p">};</span>
</pre></div>
</div>
<p>In the implementation, the scene gets attached to the view first. The view is a widget and gets arranged in our container widget. In the end, we add a small rectangle to the scene, which is then rendered on the view.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;customwidgetv2.h&quot;</span><span class="cp"></span>

<span class="n">CustomWidget</span><span class="o">::</span><span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_view</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QGraphicsView</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_scene</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QGraphicsScene</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_view</span><span class="o">-&gt;</span><span class="n">setScene</span><span class="p">(</span><span class="n">m_scene</span><span class="p">);</span>

    <span class="n">QVBoxLayout</span> <span class="o">*</span><span class="n">layout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">setMargin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_view</span><span class="p">);</span>
    <span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span>

    <span class="n">QGraphicsItem</span><span class="o">*</span> <span class="n">rect1</span> <span class="o">=</span> <span class="n">m_scene</span><span class="o">-&gt;</span><span class="n">addRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">NoPen</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="s">&quot;#FFBB33&quot;</span><span class="p">));</span>
    <span class="n">rect1</span><span class="o">-&gt;</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QGraphicsItem</span><span class="o">::</span><span class="n">ItemIsFocusable</span><span class="o">|</span><span class="n">QGraphicsItem</span><span class="o">::</span><span class="n">ItemIsMovable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="adapting-data">
<h3>2.3.3. Adapting Data<a class="headerlink" href="#adapting-data" title="Permalink to this headline">Â¶</a></h3>
<p>Up to now, we have mostly covered basic data types and how to use widgets and graphics views. In your applications, you will often need a larger amount of structured data, which may also need to be stored persistently. Finally, the data also needs to be displayed. For this, Qt uses models. A simple model is the string list model, which gets filled with strings and then attached to a list view.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">m_view</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QListView</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">m_model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QStringListModel</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setModel</span><span class="p">(</span><span class="n">m_model</span><span class="p">);</span>

<span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;</span> <span class="n">cities</span><span class="p">;</span>
<span class="n">cities</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Munich&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Paris&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;London&quot;</span><span class="p">;</span>
<span class="n">m_model</span><span class="o">-&gt;</span><span class="n">setStringList</span><span class="p">(</span><span class="n">cities</span><span class="p">);</span>
</pre></div>
</div>
<p>Another popular way to store and retrieve data is SQL. Qt comes with SQLite embedded, and also has support for other database engines (e.g. MySQL and PostgreSQL). First, you need to create your database using a schema, like this:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">city</span> <span class="p">(</span><span class="n">name</span> <span class="nb">TEXT</span><span class="p">,</span> <span class="n">country</span> <span class="nb">TEXT</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">city</span> <span class="n">value</span> <span class="p">(</span><span class="ss">&quot;Munich&quot;</span><span class="p">,</span> <span class="ss">&quot;Germany&quot;</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">city</span> <span class="n">value</span> <span class="p">(</span><span class="ss">&quot;Paris&quot;</span><span class="p">,</span> <span class="ss">&quot;France&quot;</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">city</span> <span class="n">value</span> <span class="p">(</span><span class="ss">&quot;London&quot;</span><span class="p">,</span> <span class="ss">&quot;United Kingdom&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>To use SQL, we need to add the SQL module to our .pro file</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">QT</span> <span class="o">+=</span> <span class="n">sql</span>
</pre></div>
</div>
<p>And then we can open our database using C++. First, we need to retrieve a new database object for the specified database engine. With this database object, we open the database. For SQLite, itâs enough to specify the path to the database file. Qt provides some high-level database models, one of which is the table model. The table model uses a table identifier and an optional where clause to select the data. The resulting model can be attached to a list view as with the other model before.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">QSqlDatabase</span> <span class="n">db</span> <span class="o">=</span> <span class="n">QSqlDatabase</span><span class="o">::</span><span class="n">addDatabase</span><span class="p">(</span><span class="s">&quot;QSQLITE&quot;</span><span class="p">);</span>
<span class="n">db</span><span class="p">.</span><span class="n">setDatabaseName</span><span class="p">(</span><span class="s">&quot;cities.db&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">db</span><span class="p">.</span><span class="n">open</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">qFatal</span><span class="p">(</span><span class="s">&quot;unable to open database&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">m_model</span> <span class="o">=</span> <span class="n">QSqlTableModel</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">m_model</span><span class="o">-&gt;</span><span class="n">setTable</span><span class="p">(</span><span class="s">&quot;city&quot;</span><span class="p">);</span>
<span class="n">m_model</span><span class="o">-&gt;</span><span class="n">setHeaderData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Horizontal</span><span class="p">,</span> <span class="s">&quot;City&quot;</span><span class="p">);</span>
<span class="n">m_model</span><span class="o">-&gt;</span><span class="n">setHeaderData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Horizontal</span><span class="p">,</span> <span class="s">&quot;Country&quot;</span><span class="p">);</span>

<span class="n">view</span><span class="o">-&gt;</span><span class="n">setModel</span><span class="p">(</span><span class="n">m_model</span><span class="p">);</span>
<span class="n">m_model</span><span class="o">-&gt;</span><span class="n">select</span><span class="p">();</span>
</pre></div>
</div>
<p>For a higher level model operations, Qt provides a sorting file proxy model that allows you sort, filter, and transform models.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">QSortFilterProxyModel</span><span class="o">*</span> <span class="n">proxy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QSortFilterProxyModel</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setSourceModel</span><span class="p">(</span><span class="n">m_model</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setModel</span><span class="p">(</span><span class="n">proxy</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setSortingEnabled</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Filtering is done based on the column that is to be filters, and a string as filter argument.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setFilterKeyColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setFilterCaseSensitive</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">CaseInsensitive</span><span class="p">);</span>
<span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setFilterFixedString</span><span class="p">(</span><span class="n">QString</span><span class="p">)</span>
</pre></div>
</div>
<p>The filter proxy model is much more powerful than demonstrated here. For now, it is enough to remember it exists.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This has been an overview of the different kind of classic applications you can develop with Qt 5. The desktop is moving, and soon the mobile devices will be our desktop of tomorrow. Mobile devices have a different user interface design. They are much more simplistic than desktop applications. They do one thing and they do it with simplicity and focus. Animations are an important part of the mobile experience. A user interface needs to feel alive and fluent. The traditional Qt technologies are not well suited for this market.</p>
<p class="last">Coming next: Qt Quick to the rescue.</p>
</div>
</div>
<div class="section" id="qt-quick-application">
<h3>2.3.4. Qt Quick Application<a class="headerlink" href="#qt-quick-application" title="Permalink to this headline">Â¶</a></h3>
<p>There is an inherent conflict in modern software development. The user interface is moving much faster than our back-end services. In a traditional technology, you develop the so-called front-end at the same pace as the back-end. This results in conflicts when customers want to change the user interface during a project, or develop the idea of a user interface during the project. Agile projects, require agile methods.</p>
<p>Qt Quick provides a declarative environment where your user interface (the front-end) is declared like HTML and your back-end is in native C++ code. This allows you to get the best of both worlds.</p>
<p>This is a simple Qt Quick UI below</p>
<div class="highlight-qml notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.5</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">240</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">1230</span>
    <span class="nx">Rectangle</span> <span class="p">{</span>
        <span class="k">width:</span> <span class="mi">40</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">40</span>
        <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>
        <span class="k">color:</span> <span class="s1">&#39;#FFBB33&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The declaration language is called QML and it needs a runtime to execute it. Qt provides a standard runtime called <code class="docutils literal notranslate"><span class="pre">qmlscene</span></code> but itâs also not so difficult to write a custom runtime. For this, we need a quick view and set the main QML document as a source. The only thing left is to show the user interface.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">QQuickView</span><span class="o">*</span> <span class="n">view</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QQuickView</span><span class="p">();</span>
<span class="n">QUrl</span> <span class="n">source</span> <span class="o">=</span> <span class="n">QUrl</span><span class="o">::</span><span class="n">fromLocalFile</span><span class="p">(</span><span class="s">&quot;main.qml&quot;</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setSource</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
<p>Letâs come back to our earlier examples. In one example, we used a C++ city model. It would be great if we could use this model inside our declarative QML code.</p>
<p>To enable this, we first code our front-end to see how we would want to use a city model. In this case, the front-end expects an object named <code class="docutils literal notranslate"><span class="pre">cityModel</span></code> which we can use inside a list view.</p>
<div class="highlight-qml notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.5</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">240</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">120</span>
    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="k">width:</span> <span class="mi">180</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">120</span>
        <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>
        <span class="k">model:</span> <span class="nx">cityModel</span>
        <span class="k">delegate:</span> <span class="nx">Text</span> <span class="p">{</span> <span class="k">text:</span> <span class="nx">model</span><span class="p">.</span><span class="nx">city</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To enable the <code class="docutils literal notranslate"><span class="pre">cityModel</span></code>, we can mostly re-use our previous model, and add a context property to our root context. The root context is the other root-element in the main document.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">m_model</span> <span class="o">=</span> <span class="n">QSqlTableModel</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">...</span> <span class="c1">// some magic code</span>
<span class="n">QHash</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">QByteArray</span><span class="o">&gt;</span> <span class="n">roles</span><span class="p">;</span>
<span class="n">roles</span><span class="p">[</span><span class="n">Qt</span><span class="o">::</span><span class="n">UserRole</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;city&quot;</span><span class="p">;</span>
<span class="n">roles</span><span class="p">[</span><span class="n">Qt</span><span class="o">::</span><span class="n">UserRole</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;country&quot;</span><span class="p">;</span>
<span class="n">m_model</span><span class="o">-&gt;</span><span class="n">setRoleNames</span><span class="p">(</span><span class="n">roles</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">rootContext</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">setContextProperty</span><span class="p">(</span><span class="s">&quot;cityModel&quot;</span><span class="p">,</span> <span class="n">m_model</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">This is not completely correct, as the SQL table model contains the data in columns and a QML model expects the data as roles. So there needs to be a mapping between columns and roles. See the <a class="reference external" href="http://wiki.qt.io/QML_and_QSqlTableModel">QML and QSqlTableModel</a> wiki page.</p>
</div>
</div>
<div class="section" id="qt-quick-controls-application">
<h3>2.3.5. Qt Quick Controls Application<a class="headerlink" href="#qt-quick-controls-application" title="Permalink to this headline">Â¶</a></h3>
<p>tbd</p>
</div>
<div class="section" id="id1">
<h3>2.3.6. Qt Quick Controls Application<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h3>
<p>tbd</p>
</div>
</div>
<div class="section" id="summary">
<h2>2.4. Summary<a class="headerlink" href="#summary" title="Permalink to this headline">Â¶</a></h2>
<p><div class="btn-group" role="group"><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook//new?labels=ch02&body=back-link%3A+ch02-start%2Fstart.html%23summary"><i class="glyphicon glyphicon-plus"></i> Issue</a><a class="btn btn-link btn-xs" href="https://github.com/qmlbook/qmlbook/?labels=ch02&page=1&state=open"><i class="glyphicon glyphicon-search"></i> Issues</a></div></p><p>We have seen how to install the Qt SDK and how to create our first application. Then we walked you through the different application types to give you an overview of Qt, showing off some features Qt offers for application development. I hope you got a good impression that Qt is a very rich user interface toolkit and offers everything an application developer can hope for and more. Still, Qt does not lock you into specific libraries, as you can always use other libraries, or even extend Qt yourself. It is also rich when it comes to supporting different application models: console, classic desktop user interface, and touch user interface.</p>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2018 JÃ¼rgen Bocklage-Ryannel and Johan Thelin. This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.<br/>
      Last updated on Nov 10, 2020.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46104829-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>